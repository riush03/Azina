<script type="text/javascript">
  function initMap() {
    var wrapper = document.getElementById("content-wrapper");
    var mapWidth = wrapper.clientWidth
    var zoomLevel = mapWidth < 900 ? (mapWidth < 500 ? 17 : 18) : 19;
    var map = new google.maps.Map(document.getElementById('map'), {
      center: new google.maps.LatLng({{page.lat}}, {{page.lon}}),
      zoom: zoomLevel,
      disableDefaultUI: false,
      mapTypeId: google.maps.MapTypeId.HYBRID
    });

    var infowindow = new google.maps.InfoWindow();

    var marker = new google.maps.Marker({
      position: new google.maps.LatLng({{page.lat}}, {{page.lon}}),
      map: map
    });

    google.maps.event.addListener(marker, 'click', function() {
      infowindow.setContent("{{page.title}}");
      infowindow.open(map, marker);
    });
  }
</script>
